<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`TrainPredict` Vignette • TrainPredict</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`TrainPredict` Vignette">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TrainPredict</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Vignette.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AU-R-Programming/Final_Project_Group_7.git" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>TrainPredict</code> Vignette</h1>
            
      

      <div class="hidden name"><code>Vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of this package is to simplify the process of sampling
data, training logistic regression models, and making binary
classification in R. In this vignette, you will find an introduction to
the main functions of the <code>TrainPredict</code> package:</p>
<ul>
<li>
<code>train_test_sampling</code>: Split your dataset into training
and test sets.</li>
<li>
<code>lr</code>: Train a logistic regression model.</li>
<li>
<code>predict_test</code>: Make predictions on the test
dataset.</li>
<li>
<code>predict_new</code>: Make predictions on new data using a model
trained with function <code>lr</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install this package you have to use the function
<code>install_github</code>, the organization name is
<code>AU-R-Programming</code> and the repository is
<code>Final_Project_Group_7</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"AU-R-Programming/Final_Project_Group_7"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-package">Load the Package<a class="anchor" aria-label="anchor" href="#load-the-package"></a>
</h2>
<p>Let’s start by loading the <code>TrainPredict</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TrainPredict</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-dataset">Example Dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>For demonstration purposes, we will use the built-in
<code>iris</code> dataset. We’ll modify it slightly to create a binary
outcome suitable for logistic regression.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preparing the dataset.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span><span class="va">iris_binary</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="va">iris_binary</span><span class="op">$</span><span class="va">Virginica</span><span class="op">&lt;-</span><span class="va">iris_binary</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">'virginica'</span></span>
<span><span class="co">#Creating a binary variable called 'Virginica' that indicates if the specie is Virginica or not.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris_binary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Virginica</span></span>
<span><span class="co">## 1          5.1         3.5          1.4         0.2  setosa     FALSE</span></span>
<span><span class="co">## 2          4.9         3.0          1.4         0.2  setosa     FALSE</span></span>
<span><span class="co">## 3          4.7         3.2          1.3         0.2  setosa     FALSE</span></span>
<span><span class="co">## 4          4.6         3.1          1.5         0.2  setosa     FALSE</span></span>
<span><span class="co">## 5          5.0         3.6          1.4         0.2  setosa     FALSE</span></span>
<span><span class="co">## 6          5.4         3.9          1.7         0.4  setosa     FALSE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-train_test_sampling">Using <code>train_test_sampling</code><a class="anchor" aria-label="anchor" href="#using-train_test_sampling"></a>
</h2>
<p>The <code>train_test_sampling</code> function is designed to split
your data into training and test sets, following a 75-25 split by
default. One of its key features is its ability to ensure equal
proportions of binary classes (0s and 1s) in both the
<code>training</code> and <code>test</code> data sets, which helps
maintain class balance for binary classification tasks.</p>
<p>Additionally, the function includes the return_data argument to give
users flexibility in the output:</p>
<ul>
<li><p>When <code>return_data</code> = <code>FALSE</code>, the function
returns only the indices of the training data set.</p></li>
<li><p>When <code>return_data</code> = <code>TRUE</code>, the function
returns a list containing two elements: the <code>training</code> data
set and the <code>test</code> data set, both with balanced class
proportions.</p></li>
</ul>
<p>For this example, we will use a 80-20 split.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_test_sampling.html">train_test_sampling</a></span><span class="op">(</span><span class="va">iris_binary</span>, dependent_var<span class="op">=</span><span class="st">"Virginica"</span>, train_prop <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                                  return_data<span class="op">=</span><span class="cn">TRUE</span>, seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># This will give us a list containing two data frames: train with 80% of the observations and test </span></span>
<span><span class="co"># with 20%.</span></span>
<span><span class="co"># Extract training and test sets.</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">split_data</span><span class="op">$</span><span class="va">train</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">split_data</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="co"># Checking the split.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    120 obs. of  6 variables:</span></span>
<span><span class="co">##  $ Sepal.Length: num  4.8 6 7 4.3 5.6 4.5 5 4.4 5.7 4.8 ...</span></span>
<span><span class="co">##  $ Sepal.Width : num  3.1 2.9 3.2 3 3 2.3 3.3 3.2 2.9 3.4 ...</span></span>
<span><span class="co">##  $ Petal.Length: num  1.6 4.5 4.7 1.1 4.5 1.3 1.4 1.3 4.2 1.9 ...</span></span>
<span><span class="co">##  $ Petal.Width : num  0.2 1.5 1.4 0.1 1.5 0.3 0.2 0.2 1.3 0.2 ...</span></span>
<span><span class="co">##  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 2 2 1 2 1 1 1 2 1 ...</span></span>
<span><span class="co">##  $ Virginica   : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    30 obs. of  6 variables:</span></span>
<span><span class="co">##  $ Sepal.Length: num  5.1 4.9 4.9 5.4 5.1 5.2 4.9 5.5 5 5.1 ...</span></span>
<span><span class="co">##  $ Sepal.Width : num  3.5 3 3.1 3.7 3.3 3.5 3.1 3.5 3.5 3.8 ...</span></span>
<span><span class="co">##  $ Petal.Length: num  1.4 1.4 1.5 1.5 1.7 1.5 1.5 1.3 1.6 1.9 ...</span></span>
<span><span class="co">##  $ Petal.Width : num  0.2 0.2 0.1 0.2 0.5 0.2 0.2 0.2 0.6 0.4 ...</span></span>
<span><span class="co">##  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Virginica   : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Checking the dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">iris_binary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 150   6</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 120   6</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30  6</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-lr-to-train-a-logistic-regression-model">Using <code>lr</code> to Train a Logistic Regression Model<a class="anchor" aria-label="anchor" href="#using-lr-to-train-a-logistic-regression-model"></a>
</h2>
<p>The <code>lr</code> function trains a logistic regression model using
numerical optimization. The goal is to find the coefficient vector
<code>β</code> that minimizes the negative log-likelihood function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo>:=</mo><mo>arg</mo><munder><mo>min</mo><mi>β</mi></munder><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\hat{\beta} := \arg\min_\beta \sum_{i=1}^n (-y_i \cdot \ln(p_i) - (1 - y_i) \cdot \ln(1 - p_i)),
</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>:=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
p_i := \frac{1}{1 + \exp(-x_i^T \beta)},
</annotation></semantics></math></p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
represent the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
observation of the response and predictors, respectively.</p>
<p>The optimization starts with initial values for <code>β</code>
obtained from the least-squares formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">
\beta_0 = (X^T X)^{-1} X^T y
</annotation></semantics></math></p>
<p>The <code>lr</code> function uses numerical optimization
(<code>optim</code> in R) to estimate the coefficients that minimize the
negative log-likelihood. The initial values for optimization are
calculated using the least-squares method, which provides a good
starting point for the optimization algorithm. The optimization process
iteratively adjusts the coefficients to find the minimum value of the
negative log-likelihood.</p>
<p>To assess the uncertainty of the estimated coefficients, we can
compute bootstrap confidence intervals. The user can specify the
significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and the number of bootstrap samples (default is 20).</p>
<p>We use a cut-off value of 0.5 to classify the predictions. Based on
this threshold, we generate a confusion matrix and calculate various
performance metrics, including:</p>
<ul>
<li>
<strong>Prevalence</strong>: The proportion of positive cases.</li>
<li>
<strong>Accuracy</strong>: The proportion of correctly classified
cases.</li>
<li>
<strong>Sensitivity</strong>: The true positive rate.</li>
<li>
<strong>Specificity</strong>: The true negative rate.</li>
<li>
<strong>False Discovery Rate</strong>: The proportion of false
positives among the predicted positives.</li>
<li>
<strong>Diagnostic Odds Ratio</strong>: The ratio of the odds of a
positive test result in a diseased individual to the odds of a positive
test result in a non-diseased individual.</li>
</ul>
<p>We use <code>Sepal.Length</code> and <code>Sepal.Width</code> as
predictors to train the model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train logistic regression model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lr.html">lr</a></span><span class="op">(</span><span class="va">Virginica</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="va">Sepal.Width</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The model will provide important information like the coefficients of the logistic regression, </span></span>
<span><span class="co"># bootstrap confidence intervals, confusion matrix, prevalence, accuracy, sensitivity, specificity, etc.</span></span>
<span></span>
<span><span class="co"># The model predicted 28 true positives, 10 false positives, 70 true negatives, and 12 false positives. </span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">confusion_matrix</span></span></code></pre></div>
<pre><code><span><span class="co">##        Predicted</span></span>
<span><span class="co">## Actual  TRUE FALSE</span></span>
<span><span class="co">##   FALSE   10    70</span></span>
<span><span class="co">##   TRUE    28    12</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The accuracy of the model is 81.6%.</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">accuracy</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8166667</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The was able to correctly identify the positives in 87.5% of the cases.</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">sensitivity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The model was able to correctly identify 87.5% of the negatives. </span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">specificity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.875</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All of these results correspond only to the training data set. </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-predict_test-for-test-data-predictions">Using <code>predict_test</code> for Test Data Predictions<a class="anchor" aria-label="anchor" href="#using-predict_test-for-test-data-predictions"></a>
</h2>
<p>We can now evaluate the model’s performance on the test data using
<code>predict_test</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predict on test dataset</span></span>
<span><span class="va">test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_test.html">predict_test</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">model</span>, new_data<span class="op">=</span><span class="va">test_data</span>, dependent_variable_col <span class="op">=</span> <span class="st">"Virginica"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Confusion Matrix:"</span></span>
<span><span class="co">##          Actual</span></span>
<span><span class="co">## Predicted  0  1</span></span>
<span><span class="co">##         0 16  3</span></span>
<span><span class="co">##         1  4  7</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The confusion matrix indicates that the model predicted 16 true negatives, 4 false negatives, 3 false </span></span>
<span><span class="co"># negatives and 7 true positives.</span></span>
<span></span>
<span><span class="co"># Display predictions.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test_predictions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    actual_outcomes predicted_outcomes</span></span>
<span><span class="co">## 1                0                  0</span></span>
<span><span class="co">## 2                0                  0</span></span>
<span><span class="co">## 10               0                  0</span></span>
<span><span class="co">## 11               0                  0</span></span>
<span><span class="co">## 24               0                  0</span></span>
<span><span class="co">## 28               0                  0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-predict_new-for-new-data-predictions">Using <code>predict_new</code> for New Data Predictions<a class="anchor" aria-label="anchor" href="#using-predict_new-for-new-data-predictions"></a>
</h2>
<p>Finally, let’s use the <code>predict_new</code> function to generate
predictions for new data points. We will create a small sample of new
observations.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating new data points for prediction</span></span>
<span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sepal.Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">6.3</span><span class="op">)</span>,</span>
<span>                       Sepal.Width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predicting using the trained model</span></span>
<span><span class="va">new_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_new.html">predict_new</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">new_data</span>, model<span class="op">=</span><span class="va">model</span>, threshold<span class="op">=</span><span class="fl">0.5</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display predictions</span></span>
<span><span class="va">new_predictions</span></span></code></pre></div>
<pre><code><span><span class="co">##   Sepal.Length Sepal.Width predicted</span></span>
<span><span class="co">## 1          5.1         3.5         0</span></span>
<span><span class="co">## 2          6.3         3.0         0</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The model predicts that both new observations are not from the Virginica specie. </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this vignette, we demonstrated how to use the
<code>TrainPredict</code> package to:</p>
<ol style="list-style-type: decimal">
<li>Split a dataset into training and test sets using
<code>train_test_sampling</code>.</li>
<li>Train a logistic regression model using <code>lr</code>.</li>
<li>Make predictions on test data using <code>predict_test</code>.</li>
<li>Generate binary classifications for new data using
<code>predict_new</code>.</li>
</ol>
<p>These functions make it easy to perform end-to-end logistic
regression modeling, from data preparation to model deployment.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>This package was developed with the aid of Large Language Models,
including ChatGPT, which provided support in brainstorming,
problem-solving, and enhancing documentation quality. The final outputs
are the result of careful review and adaptation to the specific goals of
this project.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>OpenAI. Predict Outcome Function - ChatGPT Output. Available at: <a href="https://chatgpt.com/share/675212cd-f6bc-800d-9c79-9dc9a6946ef9" class="external-link uri">https://chatgpt.com/share/675212cd-f6bc-800d-9c79-9dc9a6946ef9</a>.
Accessed: 2024-12-05.</li>
<li>OpenAI. Logistic Regression with Bootstrapping - ChatGPT Output.
Available at: <a href="https://chatgpt.com/share/675212cd-f6bc-800d-9c79-9dc9a6946ef9" class="external-link uri">https://chatgpt.com/share/675212cd-f6bc-800d-9c79-9dc9a6946ef9</a>.
Accessed: 2024-12-01.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Erick Gutierrez, Azaz Zaman, Roberto Molinari, Shakiba Kazemian.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
