<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict Outcomes and Evaluate Model Performance on Test Data Set — predict_test • TrainPredict</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict Outcomes and Evaluate Model Performance on Test Data Set — predict_test"><meta property="og:description" content="This function predicts outcomes for a new data set using a provided logistic regression model obtained with function lr and compares these predictions to the actual outcomes using a confusion matrix. The model must contain optimized beta coefficients (`beta_optimized`) and factor mappings (`factor_mappings`). The function allows for numeric conversion of factor variables in the new data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TrainPredict</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vignette.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AU-R-Programming/Final_Project_Group_7.git" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict Outcomes and Evaluate Model Performance on Test Data Set</h1>

    <div class="hidden name"><code>predict_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function predicts outcomes for a new data set using a provided logistic regression model obtained with function <code>lr</code> and compares these predictions to the actual outcomes using a confusion matrix. The model must contain optimized beta coefficients (`beta_optimized`) and factor mappings (`factor_mappings`). The function allows for numeric conversion of factor variables in the new data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_test</span><span class="op">(</span><span class="va">new_data</span>, <span class="va">model</span>, <span class="va">dependent_variable_col</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-new-data">new_data<a class="anchor" aria-label="anchor" href="#arg-new-data"></a></dt>
<dd><p>A data frame containing the new observations to predict. The column names should match the predictor names in the model.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A list containing the logistic regression model details. It must have two components:
- `beta_optimized`: A matrix of optimized beta coefficients, including an intercept term.
- `factor_mappings`: A list where each element represents the mapping of levels to numeric values for factor variables.</p></dd>


<dt id="arg-dependent-variable-col">dependent_variable_col<a class="anchor" aria-label="anchor" href="#arg-dependent-variable-col"></a></dt>
<dd><p>A character string specifying the name or number of the column in `new_data` containing the actual outcomes for evaluation purposes.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with two columns:
 - `actual_outcomes`: Actual values of the dependent variable in the test data set.
	- `predicted_outcomes`: Predicted outcomes as "TRUE" or "FALSE".
#'</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function first converts any factor variables in the new data to numeric values based on the mappings provided in the model. Then, it extracts the predictors required by the model, calculates the log-odds, and converts them to probabilities using the logistic function. Predictions are classified as either "TRUE" or "FALSE" based on a probability threshold of 0.5. A confusion matrix is printed to assess the accuracy of the predictions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="lr.html">lr</a></code>, <code>train_test_sample</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Using the mtcars dataset with 'am' as the binomial dependent variable.</span></span></span>
<span class="r-in"><span><span class="co"># First create a training and test sets from original data using function \code{train_test_sampling}</span></span></span>
<span class="r-in"><span><span class="va">split_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="train_test_sampling.html">train_test_sampling</a></span><span class="op">(</span><span class="va">mtcars</span>, dependent_var <span class="op">=</span> <span class="st">'am'</span>, train_prop <span class="op">=</span> <span class="fl">0.75</span>, return_data <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_data</span><span class="op">&lt;-</span><span class="va">split_data</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span><span class="va">test_data</span><span class="op">&lt;-</span><span class="va">split_data</span><span class="op">$</span><span class="va">test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For this example we will create a model object using function \code{lr} using the training data, and variable am as the dependent variable.</span></span></span>
<span class="r-in"><span><span class="va">lrcars</span><span class="op">&lt;-</span><span class="fu"><a href="lr.html">lr</a></span><span class="op">(</span><span class="va">am</span><span class="op">~</span><span class="va">hp</span><span class="op">+</span><span class="va">mpg</span><span class="op">+</span><span class="va">wt</span>, data<span class="op">=</span><span class="va">train_data</span>, B<span class="op">=</span><span class="fl">50</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now that we have created a logistic regression model with the training data, we test the performance of the model in new unseen data stored in the test data set.</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">&lt;-</span><span class="fu">predict_test</span><span class="op">(</span><span class="va">test_data</span>, <span class="va">lrcars</span>, <span class="st">"am"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confusion Matrix:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Actual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0 5 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1 0 3</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     actual_outcomes predicted_outcomes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout                 0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merc 230                          0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cadillac Fleetwood                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lincoln Continental               0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dodge Challenger                  0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fiat X1-9                         1                  1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Predicting outcomes on a binary subset of the Iris dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris_binary</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"setosa"</span>, <span class="st">"versicolor"</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">iris_binary</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">iris_binary</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a training and test sets from original data using function \code{train_test_sampling}</span></span></span>
<span class="r-in"><span><span class="va">iris_binary_samples</span><span class="op">&lt;-</span><span class="fu"><a href="train_test_sampling.html">train_test_sampling</a></span><span class="op">(</span><span class="va">iris_binary</span>, dependent_var<span class="op">=</span><span class="st">"Species"</span>, train_prop<span class="op">=</span><span class="fl">0.75</span>, return_data<span class="op">=</span><span class="cn">TRUE</span>, seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris_train</span><span class="op">&lt;-</span><span class="va">iris_binary_samples</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span><span class="va">iris_test</span><span class="op">&lt;-</span><span class="va">iris_binary_samples</span><span class="op">$</span><span class="va">test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a logistic regression model using function \code{lr}</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="lr.html">lr</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="va">Sepal.Width</span>, data <span class="op">=</span> <span class="va">iris_train</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict outcomes on test data</span></span></span>
<span class="r-in"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">predict_test</span><span class="op">(</span>new_data <span class="op">=</span> <span class="va">iris_test</span>, model <span class="op">=</span> <span class="va">model</span>, dependent_variable_col <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confusion Matrix:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Actual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0 12  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1  0 12</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    actual_outcomes predicted_outcomes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16               0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22               0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23               0                  0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Erick Gutierrez, Azaz Zaman, Roberto Molinari, Shakiba Kazemian.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

